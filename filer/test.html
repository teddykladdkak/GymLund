<!DOCTYPE html>
<html>
<head>
	<title>Test nya gym</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<script src="library/gymlund.js" type="text/javascript"></script>
	<script type="text/javascript">
		function check(){
			var textarea = JSON.parse(document.getElementById('data').value);
			/*console.log(textarea.gyms)
			console.log(textarea.gyms.length)
			console.log(textarea.gyms[0])
			for (var i = gyms.length - 1; i >= 0; i--) {
				gyms[i]
			}*/
			var nyagym = [];
			Object.entries(textarea.gyms).forEach(([key, val]) => {
				var name = removespace(val.name);
				nyagym.push({"namn": name, "latitude": val.latitude, "longitude": val.longitude})
			});
			console.log(nyagym)
			analysera(nyagym);
		};
		function removespace(name){
			var namesplit = name.split('');
			if(namesplit[namesplit.length - 1] == ' '){
				namesplit[namesplit.length - 1] = '';
			};
			return namesplit.join('');
		}
		function analysera(nyagym){
			for (var i = nyagym.length - 1; i >= 0; i--) {
				var finns = true;
				for (var a = gyms.length - 1; a >= 0; a--) {
					if(gyms[a].namn.toLowerCase() == nyagym[i].namn.toLowerCase()){
						var finns = false;
					};
				};
				if(!finns){
					
				}else{print(nyagym[i]);};
			};
			for (var a = gyms.length - 1; a >= 0; a--) {
				var finns = true;
				for (var i = nyagym.length - 1; i >= 0; i--) {
					if(gyms[a].namn.toLowerCase() == nyagym[i].namn.toLowerCase()){
						var finns = false;
					};
				};
				if(!finns){
					
				}else{
					addparagraf('rip: "' + gyms[a].namn + '" (' + gyms[a].rip + ')', 0)
					addlink(gyms[a].location.longitud, gyms[a].location.latitud);
				};
			};
		};
		function addlink(longitud, latitud){
			var wrapper = document.getElementById('resultat');
				var a = document.createElement('a');
					a.setAttribute('href', 'https://www.google.com/maps?q=' + longitud + ',' + latitud)
					var atext = document.createTextNode('Google Maps');
					a.appendChild(atext);
				wrapper.appendChild(a);
		};
		function addparagraf(text, indent){
			var wrapper = document.getElementById('resultat');
				var p = document.createElement('p');
					p.setAttribute('style', 'margin-left: ' + (indent * 20) + 'px;')
					var ptext = document.createTextNode(text);
					p.appendChild(ptext);
				wrapper.appendChild(p);
		}
		function print(gyminfo){
			addparagraf('{', 0);
			addparagraf('namn: \'' + gyminfo.namn + '\',', 1);
			addparagraf('id: \'\',', 1);
			addparagraf('location: {', 1);
			addparagraf('longitud: \'' + gyminfo.latitude + '\',', 2);
			addparagraf('latitud: \'' + gyminfo.longitude + '\'', 2);
			addparagraf('},', 1);
			addparagraf('embed: \'\',', 1);
			addparagraf('exraid: false,', 1);
			addparagraf('rip: false', 1);
			addparagraf('},', 0);
		};
	</script>
</head>
<body>
<textarea id="data"></textarea>
<input type="button" value="Analysera" onclick="check()">
<div id="resultat"></div>
</body>
</html>